EDR Basics: File Integrity Monitoring (FIM) using Wazuh
-->Objective

   The objective of this task is to help students understand how Wazuh File Integrity Monitoring (FIM) detects unauthorized file changes on a Windows endpoint.
   In this lab, students configure FIM, simulate unauthorized file modifications, and analyze alerts generated by Wazuh. 
   This exercise mirrors real SOC workflows where analysts track file tampering, detect suspicious modifications, and investigate early indicators of compromise.

-->Requirements

   Wazuh Server: Installed and operational

   Windows Machine: Wazuh agent installed and connected

   Administrative privileges on the Windows endpoint

-->Step 1: Configure Wazuh FIM on the Server

  Edit the server configuration:

  sudo nano /var/ossec/etc/ossec.conf


  Add a monitoring rule:

  <syscheck>
      <frequency>600</frequency>
      <directories check_all="yes">C:\Users\Public\Documents</directories>
  </syscheck>


   This allows Wazuh to monitor the Public Documents folder for any file creation, modification, deletion, or permission changes.

  Restart Wazuh Manager:

  sudo systemctl restart wazuh-manager

-->Step 2: Simulate a File Tampering Attack on Windows

   In PowerShell (Run as Administrator):

   Create a file:

   echo "Sensitive data" > C:\Users\Public\Documents\important.txt


    Modify the file:

    echo "Unauthorized modification detected" >> C:\Users\Public\Documents\important.txt


    Delete the file:

    Remove-Item C:\Users\Public\Documents\important.txt -Force

-->Step 3: Detect File Changes in Wazuh

   Open the Wazuh Dashboard → Security Events → File Integrity Monitoring.

   Search for specific FIM events:

   rule.group:FIM AND data.win.eventdata.targetFilename:"C:\\Users\\Public\\Documents\\important.txt"


   Look for:

   File Created

   File Modified

   File Deleted

   Attribute/Permission changes

-->What I Observed

    Wazuh successfully captured all file-related activities, including creation, content changes, and deletion. 
    Each action generated corresponding alerts with metadata such as timestamp, user, event type, and file path. 
    This clearly demonstrates how Wazuh’s FIM component provides real-time visibility into unauthorized changes, helping SOC analysts identify tampering attempts, detect early-stage attacks, and preserve forensic evidence.

-->Submission

   Screenshot of Wazuh Dashboard showing detected file changes

   Screenshot of logs confirming file modification and deletion events


-->Conclusion

   In this task, I configured Wazuh FIM, simulated unauthorized file changes on Windows, and observed how Wazuh logs these events for security monitoring. 
   This exercise highlights how FIM supports SOC analysts in detecting suspicious activity, identifying tampering, and strengthening endpoint security.
